context("Multiple Means")

outcomes <- structure(list(Q050__1 = c(NA, 4L, 4L, 3L, 5L, NA, 4L, NA, NA,
3L, 2L, 3L, 5L, NA, 5L, NA, NA, 4L, NA, NA), Q050__2 = c(4L,
4L, NA, NA, NA, NA, NA, 5L, NA, NA, 4L, 4L, 5L, NA, NA, NA, 5L,
NA, NA, NA), Q050__3 = c(3L, NA, 4L, NA, NA, 3L, 3L, NA, NA,
NA, 4L, NA, NA, 3L, 5L, 5L, NA, NA, NA, 3L), Q050__4 = c(4L,
NA, NA, NA, 5L, 4L, 4L, 5L, NA, 4L, 4L, NA, NA, NA, NA, 2L, NA,
NA, NA, NA), Q050__5 = c(NA, 3L, NA, NA, NA, 2L, 4L, 3L, 4L,
NA, NA, 4L, 4L, 3L, 4L, NA, 4L, NA, NA, 3L), Q050__6 = c(5L,
4L, NA, NA, NA, 5L, NA, NA, 4L, 5L, NA, 5L, NA, NA, NA, 4L, 3L,
4L, 4L, 3L), Q050__7 = c(5L, 4L, NA, 5L, NA, NA, NA, NA, 4L,
NA, NA, NA, 5L, 5L, NA, 5L, NA, NA, 4L, 3L), Q050__8 = c(NA,
NA, 4L, 4L, 4L, NA, 5L, 2L, NA, 4L, NA, NA, NA, 5L, NA, NA, 4L,
4L, 4L, 3L), Q050__9 = c(5L, 4L, NA, NA, NA, 2L, NA, 3L, NA,
NA, NA, NA, NA, NA, NA, 4L, 2L, 3L, 3L, NA), Q050__10 = c(NA,
NA, 5L, NA, NA, 5L, 4L, NA, NA, NA, 4L, NA, 5L, NA, 4L, NA, NA,
5L, NA, NA), Q050__11 = c(5L, NA, NA, 5L, 5L, NA, NA, 5L, 5L,
5L, 5L, 4L, 5L, 5L, NA, 5L, NA, NA, 4L, NA), Q050__12 = c(5L,
NA, NA, 5L, 5L, 4L, NA, NA, NA, 4L, NA, NA, NA, NA, NA, NA, NA,
4L, NA, NA), Q050__13 = c(4L, NA, 5L, NA, 4L, NA, NA, NA, 5L,
NA, NA, 4L, 5L, 4L, NA, 3L, 5L, 4L, NA, 3L), Q050__14 = c(NA,
4L, 5L, NA, NA, 4L, NA, 5L, 4L, NA, NA, NA, 5L, 5L, 4L, NA, NA,
5L, 5L, NA), Q050__15 = c(5L, 5L, NA, NA, 5L, NA, 4L, 4L, 5L,
NA, NA, 4L, NA, 5L, 5L, NA, 5L, NA, 4L, 5L), Q050__16 = c(NA,
NA, 5L, 4L, 4L, NA, 5L, NA, NA, NA, NA, 4L, NA, NA, 5L, 5L, 5L,
5L, NA, 5L), Q050__17 = c(NA, NA, 5L, 4L, NA, NA, 4L, 4L, NA,
NA, NA, NA, 5L, NA, NA, NA, 4L, NA, 4L, NA), Q050__18 = c(NA,
3L, 3L, 3L, 3L, NA, 4L, 2L, NA, 3L, 3L, 3L, NA, NA, 3L, NA, NA,
NA, 3L, NA), Q050__19 = c(NA, NA, NA, NA, NA, 3L, NA, NA, 3L,
NA, NA, 5L, NA, 1L, 2L, 5L, NA, NA, 3L, NA), Q050__20 = c(5L,
NA, 5L, 4L, NA, NA, NA, 4L, 4L, 4L, 4L, NA, 4L, 4L, 3L, 4L, 5L,
NA, NA, NA), Q050__21 = c(NA, 5L, 5L, NA, 5L, NA, NA, NA, 5L,
NA, NA, NA, 5L, NA, 3L, 5L, NA, 5L, NA, 5L), Q050__22 = c(NA,
NA, NA, 3L, 5L, 5L, 4L, 4L, NA, 4L, 4L, NA, NA, 3L, 4L, 4L, NA,
NA, NA, 3L), Q050__23 = c(NA, 3L, NA, 2L, NA, NA, 4L, NA, 4L,
2L, 3L, NA, 5L, NA, NA, NA, NA, NA, 3L, 3L), Q050__24 = c(5L,
2L, 3L, NA, 3L, 3L, NA, NA, NA, 2L, 3L, 2L, NA, NA, NA, NA, 2L,
3L, 2L, NA), Q050__25 = c(NA, NA, NA, 2L, NA, 5L, NA, NA, 4L,
4L, 3L, 4L, NA, 2L, NA, NA, 3L, 5L, NA, 4L)), row.names = c("1",
"2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13",
"14", "15", "16", "17", "18", "19", "20"), class = "data.frame")

predictor <- structure(c(2L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L,
1L, 1L, 2L, 1L, 2L, 1L, 1L), .Label = c("Cluster 1\n47%", "Cluster 2\n53%"
), class = "factor")

test_that("Multiple means data frame output",
{
    expected <- structure(c(3.4, 4.5, 3.75, 4.33333333333333, 3.33333333333333,
                3.8, 4.2, 3.71428571428571, 3, 4, 4.83333333333333, 4.5, 4, 4.6,
                4.71428571428571, 4.75, 4, 2.85714285714286, 2, 4, 4.33333333333333,
                3.57142857142857, 2.66666666666667, 2.2, 3, 4.16666666666667,
                4.33333333333333, 3.6, 3.8, 3.6, 4.5, 4.75, 4.25, 3.5, 4.8, 4.83333333333333,
                4.5, 4.25, 4.6, 4.6, 4.66666666666667, 4.66666666666667, 3.25,
                4, 4.4, 5, 4.5, 4.33333333333333, 3.16666666666667, 4.5, 0.166352201257862,
                0.0277777777777778, 0.00833333333333333, 0.0888888888888889,
                0.041025641025641, 0.237096774193548, 0.159210526315789, 0.105733082706767,
                0.0666666666666667, 0.533333333333333, NA, 0, 0.0241935483870968,
                2.62953635073671e-31, 0.0142857142857143, 0.00793650793650794,
                0.533333333333333, 0.196428571428571, 0.533333333333333, 0.127272727272727,
                0.25, 0.447089947089947, 0.735294117647059, 0.311481481481481,
                0.519230769230769, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                1, 1, 1, 1, 1, 1, 1, 1, 0.156019171716493, 1, 0.936358871997522),
                .Dim = c(25L, 4L), .Dimnames = list(c("Q050__1", "Q050__2",
                                             "Q050__3", "Q050__4", "Q050__5", "Q050__6", "Q050__7", "Q050__8",
                                             "Q050__9", "Q050__10", "Q050__11", "Q050__12", "Q050__13", "Q050__14",
                                             "Q050__15", "Q050__16", "Q050__17", "Q050__18", "Q050__19", "Q050__20",
                                             "Q050__21", "Q050__22", "Q050__23", "Q050__24", "Q050__25"),
                                           c("Cluster 1 47%", "Cluster 2 53%", "R_Squared", "p")))

    result <- MultipleMeans(outcomes, predictor, return.data.frame = TRUE)
    expect_equal(result, expected)
})
